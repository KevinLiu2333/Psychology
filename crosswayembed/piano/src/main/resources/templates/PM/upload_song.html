<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>克洛斯威钢琴端后台管理系统</title>
<link rel="stylesheet" href="/css/bootstrap.css" />
<link rel="stylesheet" href="/css/css.css" />
<link href="/css/zzsc.css" type="text/css" rel="stylesheet" />
<script src="/js/jquery-1.3.2.js" type="text/javascript"></script>
<script type="text/javascript">
	$(function() {
		$("#hmidPath").val("");
		var result = $("#result").val();
		if (result == "0") {
			alert("上传文件为空");
		} else if (result == "1") {
			alert("上传异常");
		} else if (result == "2") {
			alert("上传文件已经存在");
		} else if (result != "") {
			$("#hmidPath").val(result);
			alert("上传文件成功");
			$("#selectFile").text("重新选择");
			$("#fileshow").text(result.substr(result.lastIndexOf("/")+1));
			/* $("#uploadButton").text("已上传"); */
		}


/* 		$(".subNav").click(
				function() {
					$(this).toggleClass("currentDd").siblings(".subNav")
							.removeClass("currentDd")
					$(this).toggleClass("currentDt").siblings(".subNav")
							.removeClass("currentDt")

					// 修改数字控制速度， slideUp(500)控制卷起速度
					$(this).next(".navContent").slideToggle(500).siblings(
							".navContent").slideUp(500);
				}); */

		$("#saveMID").click(function() {
			var hmidPath = $("#hmidPath").val();
			if (hmidPath == "") {
				alert("您还没有上传文件");
				return;
			}
			$("#midclass").val($("option:selected").val());
			$("#addMidForm").submit();
		});

		$("#turnBack").click(function() {
			window.location.href = "/PM/PM_MidList";
		});


	})


	var fileName;
	
	function filechange(file) {
		/* $("#uploadButton").text("提交"); */
		var filePath = $(file).val();
		fileName = filePath.substr(filePath.lastIndexOf("\\") + 1);
		$("#fileshow").text(fileName);
		$("#selectFile").text("重新选择");
	}
	
	function checkFile(fileName) {
		var suffix = fileName.substr(fileName.lastIndexOf(".") + 1);
		var suffixArray = [ "tmf", "mid" ];
		if ($.inArray(suffix, suffixArray) == -1) {
			alert("上传文件类型错误");
			return false;
		}
		return true;
	}
</script>
</head>
<body>
	<!-- 顶部 -->
	<div th:include="common/head"></div>
	<div id="middle">
		<div th:include="common/left"></div>

		<div class="right" id="mainFrame">


			<div class="right_cont">
				<ul class="breadcrumb">当前位置： 上传曲谱
				</ul>
				<div style="width: 1100px; margin: auto; margin-top: 100px;">
					<table class="table table-bordered">
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>曲谱名</b></td>
							<td width="38%"><input type="text" name="input" id="input"
								class="span1-1" /></td>
						</tr>
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>原作者</b></td>
							<td width="38%"><input type="text" name="input" id="input"
								class="span1-1" /></td>
						</tr>
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>出自作品集</b></td>
							<td width="38%"><input type="text" name="input" id="input"
								class="span1-1" /></td>
						</tr>
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>文件大小</b>（如：80kb,1MB等）</td>
							<td width="38%"><input type="text" name="input" id="input"
								class="span1-1" /></td>
						</tr>
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>Midi分类</b></td>
							<td width="38%"><select id="MidiSort" class="span1-1"
								style="height: 30px;">
									<option>古典精选</option>
									<option>经典音乐</option>
									<option>流行音乐</option>
									<option>影视原声</option>
									<option>游戏动漫</option>
							</select></td>
						</tr>
						<tr>
							<td width="12%" height="39" align="right" nowrap="nowrap"
								bgcolor="#f1f1f1"><b>选择文件</b></td>
							<td width="38%">
								<form id="uploadForm" action="/PM/uploadMID" method="post"
									enctype="multipart/form-data" onsubmit="return checkFile(fileName);">
									<div class="ab-box"
										style="padding-bottom: 0px; margin-top: 20px; height: 30px; position: relative;">
										<div style="position: absolute; left: 0px; top: 0px;">
											<div id="fileshow" class="fileshow"></div>
											<span class="ctrl-file"> <input type="file"
												class="filehide" name="file" onchange="filechange(this)"/>
												<a id="selectFile" href="#">选择文件</a>
											</span>
											<!-- <button id="uploadButton" class="submit-file" type="submit">提交</button> -->
										</div>
									</div>
								</form>
							</td>
						</tr>
					</table>
					<input id="result" type="hidden" th:value="${result}"
						th:if="${result}" />
					<form id="addMidForm" action="/PM/addMID" method="post">
						<input type="hidden" id="hmidPath" name="hmidPath" /> <input
							type="hidden" id="midclass" name="midclass" />
					</form>
					<table class="margin-bottom-20 table  no-border">
						<tr>
							<td class="text-center"><input id="saveMID" type="submit"
								value="保存" class="btn btn-info " style="width: 80px;" /> <input
								id="turnBack" type="button" value="返回" class="btn btn-info "
								style="width: 80px; margin-left: 10px;" /></td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
