<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>个人信息</title>
<link href="/css/style.css" rel="stylesheet" type="text/css"/>
<link href="/css/center.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript">
	$(function(){
		var user_sex = $("#sex_hidden").val();
		var user_birth = $("#birth_hidden").val();
		
		if(user_sex != null || user_sex != "") {
			var radios = $(".jdradio");
			for(var i=0;i<radios.length;i++) {
				if(radios.eq(i).val() == user_sex) {
					radios.eq(i).attr("checked","checked");
					break;
				}
				continue;
			}
		}
		
		if(user_birth != null || user_birth != "") {
			var birthArray = user_birth.split("-");
			var year_options = $("#birthdayYear").children();
			var month_options = $("#birthdayMonth").children();
			var day_options = $("#birthdayDay").children();
			for(var i=0;i<year_options.length;i++) {
				if(year_options.eq(i).val() == birthArray[0]) {
					year_options.eq(i).attr("selected","selected");
					break;
				}
				continue;
			}
			for(var i=0;i<month_options.length;i++) {
				if(month_options.eq(i).val() < 10 && ("0"+month_options.eq(i).val()) == birthArray[1]) {
					month_options.eq(i).attr("selected","selected");
					break;
				}
				if(month_options.eq(i).val() == birthArray[1]) {
					month_options.eq(i).attr("selected","selected");
					break;
				}
				continue;
			}
			for(var i=0;i<day_options.length;i++) {
				if(day_options.eq(i).val() == birthArray[2]) {
					day_options.eq(i).attr("selected","selected");
					break;
				}
				continue;
			}
		}
		
		if($("#emailShow").text() == "") {
			$("#joinEmail").text("绑定我的邮箱");
		} else {
			$("#joinEmail").text("更换绑定邮箱");
		}
		$("#joinEmail").click(function(){
			var email1 = prompt("请输入您的邮箱：","");
			if(email1 != null || email1 != "") {
				$("#emailShow").text(email1);
				$(this).text("更换绑定邮箱");
			} else {
				$(this).text("绑定我的邮箱");
			}
		});
		
		$("#changeMobile").click(function(){
			var mobile = $("#mobileShow").text();
			var mobile2 = prompt("请输入手机号:","");
			if(mobile2 != null || mobile2 != "") {
				$("#mobileShow").text(mobile2);
			}
			$("#mobileShow").text(mobile);
		});
		
 		$("#bcxg").click(function(){
			var nickname = $("#nickShow").val();
			var sex = $(".jdradio:checked").val();
			var email = $("#emailShow").text();
			var telephone = $("#mobileShow").text();
			var birth = $("#birthdayYear>option:selected").val()+"-"+
						$("#birthdayMonth>option:selected").val()+"-"+
						$("#birthdayDay>option:selected").val();
			$("#nickname_hidden").val(nickname);
			$("#sex_hidden").val(sex);
			$("#email_hidden").val(email);
			$("#telephone_hidden").val(telephone);
			$("#birth_hidden").val(birth);
			$("#modifyForm").submit();
		});
	})
</script>
</head>

<body>
<div class="navhead" style="border-bottom:1px solid #ddd;">
	<nav class="index-nav">
		<div class="logo">
			<a href="/index.html"><img src="/images/logo.png" /></a>
		</div>
		<div class="shopcart">
			<a href="/cart"> </a>
		</div>
        <div class="exit" th:if="${session.klsw_user }">
			<a href="/logout">退出</a>
		</div>
		<div class="login">
			<a href="/order/list"></a>
		</div>
		<ul class="nav-list">

			<li class="nav-item"><a href="/">首页</a></li>

			<li class="nav-item"><a href="/smart.html">智能钢琴</a></li>

			<li class="nav-item"><a href="/mall" class="orange">在线商城</a></li>

			<li class="nav-item"><a href="/service.html">服务中心</a></li>

			<li class="nav-item"><a href="/aboutus.html">关于我们</a></li>

		</ul>
	</nav>
</div>

<div class="center_info"> 

<div th:include="common/center"></div> 
<div class="center_infor">
<div class="myorder_top">个人信息管理</div>
<form id="modifyForm" action="/information/modifyMessage" method="post" enctype="multipart/form-data">
<div class=" message_tou">
<div class="mess_pc">
						<a href="#"><i class="mask"></i></a>
						<img id="myImage" th:src="${session.klsw_user.imgpath}"/>
				  </div>
               <div class=" mess_set">                 
               <span class="ctrl-file1">
                  <input id="myFile" type="file" class="filehide1" name="filehide" onChange="filechange(this)"/>
                  <a href="#">设置头像</a>
                </span>
                </div>
</div>
<input type="hidden" id="nickname_hidden" name="nickname" value="" />
<input type="hidden" id="sex_hidden" name="sex" th:value="${session.klsw_user.sex}" />
<input type="hidden" id="email_hidden" name="email" value="" />
<input type="hidden" id="telephone_hidden" name="mobile" value="" />
<input type="hidden" id="birth_hidden" name="birth" th:value="${#calendars.format(session.klsw_user.birth,'yyyy-MM-dd')}" />
</form>
<div class="mess_phone">
   <ul>
      <li>
         <div class="mess_bangding">昵称：</div>
         <div class="mess_change"><input id="nickShow" name="" type="text" value="jasonchien" class="itxt" th:value="${session.klsw_user.nickname}"/></div>
       </li>
      <li>
         <div class="mess_bangding">性别：</div>
         <div class="mess_change">
                                        <input type="radio" name="sex" class="jdradio" value="男"/><label class="mr10">男</label>
                                        <input type="radio" name="sex" class="jdradio" value="女"/><label class="mr10">女</label>
                                        <input name="sex" type="radio" class="jdradio" value="保密" checked="checked"/><label class="mr10">保密</label>
         </div>
       </li>
      <!-- <li style="height: 90px;">
         <div class="mess_bangding" style=" line-height:41px;">邮箱：</div>
         <div class="mess_change" style="display:none;"><a id="emailShow" href="#" style="background-color:#FFE7BA;"></a></div>
         <div class="mess_change"><a id="joinEmail" href="#">绑定我的邮箱</a></div>
       </li>  -->  
       <li>
         <div class="mess_bangding" style=" line-height:41px;">邮箱：</div>
         <div class="mess_change"><a id="emailShow" href="#" th:text="${session.klsw_user.email}"></a></div>
         <div class="bd_change" style=" display:block;"><a id="joinEmail" href="#">绑定我的邮箱</a></div>                  
       </li>     
      <li>
         <div class="mess_bangding" style=" line-height:40px;">登录手机：</div>
         <div class="mess_change"><span id="mobileShow" th:text="${session.klsw_user.mobile}">186****2939</span><a href="#" style=" width:115px; margin-left:62px;" id="changeMobile">更换</a></div>
       </li>              
      <li>
         <div class="mess_bangding">生日：</div>
         <div class="mess_change">
                                        <select name="" class="selt selt1" id="birthdayYear"><option value="请选择"  selected="selected">请选择</option><option value="2016" >2016</option><option value="2015">2015</option><option value="2014">2014</option><option value="2013">2013</option><option value="2012">2012</option><option value="2011">2011</option><option value="2010">2010</option><option value="00后">00后</option><option value="2009">2009</option><option value="2008">2008</option><option value="2007">2007</option><option value="2006">2006</option><option value="2005">2005</option><option value="2004">2004</option><option value="2003">2003</option><option value="2002">2002</option><option value="2001">2001</option><option value="2000">2000</option><option value="90后">90后</option><option value="1999">1999</option><option value="1998">1998</option><option value="1997">1997</option><option value="1996">1996</option><option value="1995">1995</option><option value="1994">1994</option><option value="1993">1993</option><option value="1992">1992</option><option value="1991">1991</option><option value="1990">1990</option><option value="80后">80后</option><option value="1989">1989</option><option value="1988">1988</option><option value="1987">1987</option><option value="1986">1986</option><option value="1985">1985</option><option value="1984">1984</option><option value="1983">1983</option><option value="1982">1982</option><option value="1981">1981</option><option value="1980">1980</option><option value="70后">70后</option><option value="1979">1979</option><option value="1978">1978</option><option value="1977">1977</option><option value="1976">1976</option><option value="1975">1975</option><option value="1974">1974</option><option value="1973">1973</option><option value="1972">1972</option><option value="1971">1971</option><option value="1970">1970</option><option value="60后">60后</option><option value="1969">1969</option><option value="1968">1968</option><option value="1967">1967</option><option value="1966">1966</option><option value="1965">1965</option><option value="1964">1964</option><option value="1963">1963</option><option value="1962">1962</option><option value="1961">1961</option><option value="1960">1960</option><option value="50后">50后</option><option value="1959">1959</option><option value="1958">1958</option><option value="1957">1957</option><option value="1956">1956</option><option value="1955">1955</option><option value="1954">1954</option><option value="1953">1953</option><option value="1952">1952</option><option value="1951">1951</option><option value="1950">1950</option><option value="40后">40后</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="30后">30后</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option></select>
                                        <label class="ml5 mr5">年</label>
                                        <select name="" class="selt selt1" id="birthdayMonth"><option value="请选择"  selected="selected">请选择</option><option value="1" >1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                        <label class="ml5 mr5">月</label>
                                        <select name="" class="selt selt1" id="birthdayDay"><option value="请选择"  selected="selected">请选择</option><option value="1" >1</option><option value="2" >2</option><option value="3" >3</option><option value="4" >4</option><option value="5" >5</option><option value="6" >6</option><option value="7" >7</option><option value="8" >8</option><option value="9" >9</option><option value="10" >10</option><option value="11" >11</option><option value="12" >12</option><option value="13" >13</option><option value="14" >14</option><option value="15" >15</option><option value="16" >16</option><option value="17" >17</option><option value="18" >18</option><option value="19" >19</option><option value="20" >20</option><option value="21" >21</option><option value="22" >22</option><option value="23" >23</option><option value="24" >24</option><option value="25" >25</option><option value="26" >26</option><option value="27" >27</option><option value="28" >28</option><option value="29" >29</option><option value="30" >30</option><option value="31" >31</option></select>
                                        <label class="ml5 mr5">日</label>
         </div>
       </li>       
    <div class="mess_save"><a href="#" id="bcxg">保存修改</a></div>             
   </ul>
</div>
</div>
</div>   
<div th:include="common/foot"></div>   
<script type="text/javascript">
	
	$(function(){
		var days = $("#birthdayDay").children();
		
		$("#birthdayMonth").click(function(){
			$("#birthdayMonth").children().attr("disabled",false);
			var year = $("#birthdayYear>option:selected").val();
			if(year == "00后" || year == "90后" || year == "80后" || year == "70后" || year == "60后"
				|| year == "50后" || year == "40后" || year == "30后") {
				
				$("#birthdayMonth").children().attr("disabled",true);
			}
		});
		
		$("#birthdayDay").click(function(){
			$("#birthdayDay").children().attr("disabled",false);
			var year = $("#birthdayYear>option:selected").val();
			var month = $("#birthdayMonth>option:selected").val();
			if(year == "00后" || year == "90后" || year == "80后" || year == "70后" || year == "60后"
					|| year == "50后" || year == "40后" || year == "30后") {
				$("#birthdayDay").children().attr("disabled",true);
			} else {
				var leapYear = (year%4 == 0 && year%100 != 0) || (year%400 == 0) ;
				switch(month)
				{
				case "1":
				case "3":
				case "5":
				case "7":
				case "8":
				case "10":
				case "12":
					days.eq(29).show();
					days.eq(30).show();
					days.eq(31).show();
					break;
				case "4":
				case "6":
				case "9":
				case "11":
					days.eq(31).hide();
					break;
				case "2":
					if(leapYear) {
						days.eq(29).show();
					} else {
						days.eq(29).hide();
					}
					days.eq(30).hide();
					days.eq(31).hide();
					break;
				default:
					break;
				}
			}
		});
	})

	var imgArray = ["gif","jpg","jpeg","png","bmp"];
	function filechange(file) {
		$("#myImage").attr("src","");
		var 
		if(file.files && file.files[0]) {
			var imgPath = $("#myFile").val();
			var fileSuffix = imgPath.substring(lastIndexOf(".");
			var reader = new FileReader();
			reader.readAsDataURL(file.files[0]);
			reader.onload = function(evt) {
				showImg(evt.target.result);
			}
		}
	}
	
	function showImg(src) {
		$("#myImage").attr("src",src);
		$("#myImage").css("display","block");
	}
</script>  
</body>
</html>
