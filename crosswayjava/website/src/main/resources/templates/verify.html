<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>验证账号</title>
<link href="/css/style.css" rel="stylesheet" type="text/css"/>
<link href="/css/login.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="/js/jquery.js"></script>
</head>

<body>
<div th:include="common/head"></div>
<div id="login_bg">
<div class="content">
<div class="register-box">
<div class="register-title">账号验证页面</div>
<div class="register-pic"><img src="/images/login_logo.png" width="122" height="75" /></div>
<form action="/verify" method="post">
<div class="reg_form reg_form_step1">
                    <dl id="dl_VerifyCode" style=" margin-top:40px; margin-bottom:40px;">
                        <dt class="label">手机号</dt>
                        <dd>
                        	<input class="short_input input_r" type="hidden" id="phone_hidden" name="phone_hidden" th:value="${phone}" th:if="${phone}"/>
                            <input class="short_input input_r" type="text" id="phone" name="phone"/>  
                              <label style="font-size: 15px;color:red;" class="cw" th:text="${phoneMsg}" th:if="${phoneMsg}"></label>
                             
                        </dd>
                    </dl>  
                    
                    <dl id="dl_VerifyCode" style=" margin-top:40px; margin-bottom:40px;">
                        <dt class="label">手机验证码</dt>
                        <dd>
                        	<input class="short_input input_r" type="hidden" id="verifyCode_hidden" name="verifyCode_hidden" th:value="${verifyCode}" th:if="${verifyCode}" />
                            <input class="short_input input_r" type="text" id="verifyCode" name="verifyCode"/>
                            <input type="button" id="btnGetYzm" style=" width:auto;  height:39px; line-height:39px;" value="获取验证码" />
                       
                        </dd>
                             
                    </dl>
                     <label style="font-size: 15px;color:red;" class="cw" th:text="${phoneCaptchaMsg}"></label> 

                    <dl>
                        <dt class="label">&nbsp;</dt>
                        <dd>
                                   <div class="submit">
                                   <button type="submit" tabindex="5" id="J_SubmitStatic">确认</button>   
                                   </div> 
                      </dd>   
                    </dl>            
        </div>
                          
</form>            
</div>
    <div class="foot_bei">
                2016 © chinacrossway.com 安徽克洛斯威智能乐器科技有限公司 | ICP证：皖ICP备15021161号-1
     </div>
</div>
</div>
<script type="text/javascript" src="/js/jquery-html5Validate.js"></script>
<script type="text/javascript">
    $(function () {
        var interval;
        function countDown($el) {
            var i = 120;
            $el.prop('disabled', true).val('重新发送('+ i + '秒)');
            setInterval(function () {
                i--;
                $el.val('重新发送('+ i + '秒)');
                if (i <= 0) {
                    clearInterval(interval);
                    interval = undefined;
                    $('#btnGetYzm').prop('disabled', false).val('发送验证码');
                }
            }, 1000);
        }
        
        function checkPhone(phone){ 
            if(!(/^1[3|4|5|7|8]\d{9}$/.test(phone))){ 
                return false; 
            }
            return true;
        }

        $('#btnGetYzm').click(function () { 
            var phone = $('#phone').val();
            var reg = /^\s*$/g;
            if(reg.test(phone)) {
            	alert('请先填写手机号码');
            	return false;
            }
            if(!checkPhone(phone)) {
            	alert("手机号码不存在"); 
            	return false;
            }
            
            var obj = $(this);
            
            $.get("/mobile/phoneCaptcha?mobile=" + phone, function(
    				data) {
    			switch (data) {
    			case "ok":
    				countDown(obj);
    				break;
    			default:
    				alert(data);
    			}
    		});
            
            
        });
    });
</script>
</body>
</html>
