<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title>数据中心监控平台</title>

    <meta name="description" content="overview &amp; stats" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link href="assets/data-tables/css/demo_page.css" rel="stylesheet" />
    <link href="assets/data-tables/css/demo_table.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/data-tables/DT_bootstrap.css" />
    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/font-awesome/4.2.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/bootstrap-datepicker.css">
    <!-- page specific plugin styles -->

    <!-- text fonts -->
    <link rel="stylesheet" href="assets/fonts/fonts.googleapis.com.css" />

    <!-- ace styles -->
    <link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

    <!--[if lte IE 9]>
			<link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->

    <!--[if lte IE 9]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->
    <script src="assets/js/ace-extra.min.js"></script>
    <style type="text/css">
        .dataTables_paginate.paging_bootstrap.pagination li {
            float: left;
            margin: 0 1px;
            border: 1px solid #ddd;
            list-style: none;
        }

        .dataTables_paginate.paging_bootstrap.pagination li.disabled a {
            color: #c7c7c7;
        }

        .dataTables_paginate.paging_bootstrap.pagination li a {
            color: #797979;
            padding: 5px 10px;
            display: inline-block;
        }

        .dataTables_paginate.paging_bootstrap.pagination li:hover a,
        .dataTables_paginate.paging_bootstrap.pagination li.active a {
            color: #fff;
            background: #65cea7;
            text-decoration: none;
        }

        .dataTables_paginate.paging_bootstrap.pagination li:hover,
        .dataTables_paginate.paging_bootstrap.pagination li.active {
            border-color: #65cea7;
        }

        .dataTables_paginate.paging_bootstrap.pagination li.disabled:hover,
        .dataTables_paginate.paging_bootstrap.pagination li.disabled:hover a {
            color: #C7C7C7;
            background: #fff;
            border-color: #DDDDDD;
            cursor: no-drop;
        }

        .dataTables_paginate.paging_bootstrap.pagination {
            float: right;
            margin-bottom: 15px;
        }
    </style>
    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
		<script src="assets/js/html5shiv.min.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<![endif]-->
</head>

<body class="no-skin">
    <div id="navbar" class="navbar navbar-default">
        <script type="text/javascript">
            try {
                ace.settings.check('navbar', 'fixed')
            } catch (e) {}
        </script>

        <div id="header"></div>
        <!-- /.navbar-container -->
    </div>

    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try {
                ace.settings.check('main-container', 'fixed')
            } catch (e) {}
        </script>

        <div id="sidebar" class="sidebar  responsive menu-min">

        </div>

        <div class="main-content">

            <div class="page-content">
                <div class="ace-settings-container" id="ace-settings-container">
                </div>

                <div class="row">
                    <div class="col-sm-12" >
                        <h2 class="page-header" style="margin-top: 5px">登录监控</h2>
                        <div class="col-md-12" style="border-bottom:1px dashed #ccc;">
                        <div class="wrapper">
                <div class="row jk-info">
                    <div class="col-md-3">
                        <div class="panel green-bg btn-success">
                            <div class="panel-body">
                                <div class="row">
                                    <div align="center">
                                        <span class="state-title"><span style="font-size:24px" id="xtdlzs">0</span>
                                        <h4 id="usedCount">系统登录总数</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="panel yellow-bg btn-info">
                            <div class="panel-body">
                                <div class="row">
                                    <div align="center">
                                        <span class="state-title" style="font-size:24px" id="jrdlzs">0</span>
                                        <h4 id="appliedCount">今日系统登录总数</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   <div class="col-md-3">
                                    <div class="panel blue-bg btn-danger">
                                        <div class="panel-body">
                                            <div class="row">
                                                <div align="center">
                                                    <span class="state-title" style="font-size:24px" id="dlyj">0</span>
                                                    <h4 id="errorCount">非工作时间登录预警</h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                     </div>
                                <div class="col-md-3">
                                    <div class="panel red-bg btn-warning">
                                        <div class="panel-body">
                                            <div class="row">
                                                <div align="center">
                                                    <span class="state-title" style="font-size:24px" id="zxrs">0</span>
                                                    <h4 id="alertCount">当前在线人数</h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                </div>
            </div>
        </div>

                        <div class="space-12"></div>
                    </div>
                    <div align="center" style="margin-top: 5px;height:400px">
                        <div id="d1" style="float:left;height:380px;width:70%"></div>
                        <div id="d2" style="float:left;height:380px;width:25%">
                            <div class="wrapper" style="margin-top:30px">
                                <div class="row">
                                    <div class="row">
                                        <div  class="width-100 label label-info label-xlg arrowed-in arrowed-right">
                                            <span align="center" style="font-family:'微软雅黑';font-size:20px">登录部门排名</span>
                                        </div>
                                    </div>
                                    <div align="left">
                                            <ul class="list-unstyled spaced">
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-danger" style="font-size:18px">1</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm0">区科委</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms0">2024</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-success" style="font-size:18px">2</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm1">区财政局</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms1">169</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-purple" style="font-size:18px">3</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm2">区房管局</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms2">127</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-grey" style="font-size:18px">4</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm3">区人社局</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms3">87</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-grey" style="font-size:18px">5</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm4">区文化局</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms4">29</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-grey" style="font-size:18px">6</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm5">区安监局</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms5">21</span>
                                                </li>
                                                <li style="border-bottom:1px dashed #BBB;">
                                                    <span class="badge badge-grey" style="font-size:18px">7</span>&nbsp;&nbsp;
                                                    <span  style="font-size:18px" id="pmm6">其他</span>
                                                    <span  style="font-size:15px;float:right;margin-right: 25px" id="pms6">13</span>
                                                </li>
                                            </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                   </div>
                    <div id="footer"></div>

                    <!--[if !IE]> -->
                    <script src="assets/js/jquery.2.1.1.min.js"></script>

                    <!-- <![endif]-->

                    <!--[if IE]>
<script src="assets/js/jquery.1.11.1.min.js"></script>
<![endif]-->

                    <!--[if !IE]> -->
                    <script type="text/javascript">
                        window.jQuery || document.write("<script src='assets/js/jquery.min.js'>" + "<" + "/script>");
                    </script>

                    <!-- <![endif]-->

                    <!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets/js/jquery1x.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
                    <script type="text/javascript">
                        if ('ontouchstart' in document.documentElement) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
                    </script>
                    <script src="assets/js/bootstrap.min.js"></script>

                    <!-- page specific plugin scripts -->

                    <!--[if lte IE 8]>
		  <script src="assets/js/excanvas.min.js"></script>
		<![endif]-->
                    <script src="assets/js/jquery-ui.custom.min.js"></script>
                    <script src="assets/js/jquery.ui.touch-punch.min.js"></script>
                    <script src="assets/js/chosen.jquery.min.js"></script>
                    <script src="assets/js/fuelux.spinner.min.js"></script>
                    <script src="assets/js/bootstrap-datepicker.min.js"></script>
                    <script src="assets/js/bootstrap-timepicker.min.js"></script>
                    <script src="assets/js/moment.min.js"></script>
                    <script src="assets/js/daterangepicker.min.js"></script>
                    <script src="assets/js/bootstrap-datepicker.min.js"></script>
                    <script src="assets/js/bootstrap-datepicker.zh-CN.min.js"></script>
                    <script src="assets/js/bootstrap-colorpicker.min.js"></script>
                    <script src="assets/js/jquery.knob.min.js"></script>
                    <script src="assets/js/jquery.autosize.min.js"></script>
                    <script src="assets/js/jquery.inputlimiter.1.3.1.min.js"></script>
                    <script src="assets/js/jquery.maskedinput.min.js"></script>
                    <script src="assets/js/bootstrap-tag.min.js"></script>
                    <script type="text/javascript" language="javascript" src="assets/data-tables/jquery.dataTables.js"></script>
                    <script type="text/javascript" src="assets/data-tables/DT_bootstrap.js"></script>
                    <!--dynamic table initialization -->
                    <script src="assets/data-tables/dynamic_table_init.js"></script>
                    <script src="js/echarts.js"></script>
                    <script src="assets/echart/chart/bar.js"></script>
                    <script src="assets/echart/chart/pie.js"></script>
                    <!-- ace scripts -->
                    <script src="assets/js/ace-elements.min.js"></script>
                    <script src="assets/js/ace.min.js"></script>

                    <!-- inline scripts related to this page -->
                    <script type="text/javascript">
                 // include
                    $("#header").load("include/header.html");
                    $("#sidebar").load("include/sidebar.html",function () {
                        $("#jksy").attr("class","");
                        $("#czjk").attr("class","active");
                        $("#dlrz").attr("class","active");
                    });
                   
                    
                    $("#footer").load("include/footer.html");
                        function loaddata(){
                            $.ajax({
                                type:"get",
                                url:"json/dlrz.json",
                                dataType:"text",
                                success:function(data){
                                    data = eval('('+data+')');
                                    $('#xtdlzs').html(data.xtdlzs);
                                    $('#jrdlzs').html(data.jrdlzs);
                                    $('#dlyj').html(data.dlyj);
                                    $('#zxrs').html(data.zxrs);
                                }
                            });
                            setTimeout("loaddata()",5000);
                        }
                        $.ajax({
                    		type:"get",
                    		url:"json/dlrz_jt.json",
                    		dataType:"text",
                    		success:function(result){
                    			var data = eval('('+result+')');
                    			
            
                    			//获取一个月的时间周期
                    			//String----date：传入的日期
                    			//Int-------days: 减去的时间周期
                    			function addDate(date,days){ 
                    				var nowDay= new Date(date);
                    				var oldDay = nowDay.setDate(nowDay.getDate() - days);
                    				var month=nowDay.getMonth()+1;
                    				var day = nowDay.getDate(); 
                    				if(month<13){ 
                    					month = month; 
                    				} 
                    				if(day<10){ 
                    					day = day;
                    				} 
                    				//var val = nowDay.getFullYear()+""+month+""+day;
                    				var val = month+"/"+day;
                    				return val; 
                    			}
                    			//时间格式化
                    			function FormatTime (strTime) {
                    			    var date = new Date(strTime);
                    			    //return date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()+" "+date.getHours()+":"+date.getMinutes()+":"+date.getSeconds();
                    				return (date.getMonth()+1)+"/"+date.getDate();
                    			}
                    			// timeArray:一个月时间周期
                    			var currentDate = new Date();
                    			var now = currentDate.getFullYear()+"-"+eval(currentDate.getMonth()+1)+"-"+currentDate.getDate();
                    			var timeArray = [];
                    			for(var i = 29;i >= 0;i--){
                    			
                    				timeArray[29-i] = addDate(now,i);
                    			}

                    			console.log(timeArray)
                    			// 创建字典对应value为0
                    			var timeData = {};
                    			for(var i = 0;i<timeArray.length;i++){
                    				timeData[timeArray[i]] = 0;
                    			}

                    			// 从服务中获取的数据与字典相替换
                    			data.DATA.monthLogin.forEach(function(result){
                    				var datetime =  FormatTime(result.datetime);
                    				var count = parseInt(result.count);
                    				console.log(datetime);
                    				for(var key in timeData){
                    					if(JSON.stringify(key) == JSON.stringify(datetime)){
                    						timeData[key] = count;
                    					}
                    				}
                    			});
                    			
                    			var dataArray = [];
                    			for(var key in timeData){
                    				dataArray.push(timeData[key]);
                    			}
                    			
                    			// charts
                    			var myChart = echarts.init(document.getElementById('d1'));
                    			option = {
                    				    title: {
                    				        text: '近30日登陆情况',
                    				        x:'center'
                    				    },
                    				    tooltip: {
                    				        trigger: 'axis'
                    				    },
                    				    toolbox: {
                    				        show: true
                    				        
                    				    },
                    				    xAxis:  {
                    				        type: 'category',
                    				        boundaryGap: false,
                    				        data: timeArray,
                    				        axisLabel: {
                    	                        'interval': 0,
                    	                        rotate: 40,
                    	                        textStyle:{
                    				    			fontSize:10
                                        		}
                                        	}
                    				    },
                    				    yAxis: {
                    				        type: 'value',
                    				        axisLabel: {
                    				            formatter: '{value}'
                    				        }
                    				    },
                    				    series: [
                    				        {
                    				            name:'登陆次数',
                    				            type:'line',
                    				            data:dataArray,
                    				            markPoint: {
                    				                data: [
                    				                    {type: 'max', name: '最大值'},
                    				                    {type: 'min', name: '最小值'}
                    				                ]
                    				            },
                    				            markLine: {
                    				                data: [
                    				                    {type: 'average', name: '平均值'}
                    				                ]
                    				            }
                    				        },
                    				    ]
                    				};
                    			myChart.setOption(option);
                    		}
                    	});
                        loaddata();
                    </script>
</body>

</html>